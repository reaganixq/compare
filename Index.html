<!DOCTYPE html>
<html>
	<head>
	<TITLE> LOG YOUR SHIT </TITLE>
	
	
	</head>
	<body>
	<!-- MAKE A FORM TO INPUT USER HERE-->
	<div='Intro'>
	HELLO WORLD!
	</div>
	
		<?php
		   /* Author: CopyBastard
			* Source: www.ntu.edu.sg/home/ehchua/programming/webprogramming
			* Purpose: Retrieve User by Username Input
			*/
			
			// Define MySQL db para
				define('DB_HOST', 'localhost');	// MySQL Server hostname
				define('DB_PORT', 3306);		// MySQL Port 
				define('DB_DATABASE', 'SayNo2XLS');	// MySQL Database Name
				define('DB_User', 'reaganix');	// MySQL Admin
				define('DB_PASS', '123');		// Admin Pass
				
				// Create DB con
				$mysqli = new mysqli(DB_HOST, DB_User, DB_PASS, DB_DATABASE, DB_PORT);
				// Assert no error
				!$mysqli->connect_errno
					or die("Error: Failed to connect: ({$mysqli->connect_errno}) {$mysqli->connect_error}");			
					echo 'INFO: Connected to MySQL @ ' . DB_HOST . ':' . DB_PORT . '/' . DB_DATABASE . '(' . DB_User .')<br >';
						
				// Drop table if exist
				$mysqli->query('DROP TABLE IF EXISTS AMSUSER')
					or die("Error: DROP PROCEDURE failed: ({$mysqli->errno}) {$mysqli->error}");
				
				// Create Procedure in DB with result set - list user by name
				$sqlStr = <<<_END
				CREATE PROCEDURE listAMSUserByName (IN inName VARCHAR(64))			
				BEGIN
					SELECT * FROM AMSUSER WHERE uName = inName;
				END
_END;
				// Drop Procedure if exists
				$mysqli->query("DROP PROCEDURE IF EXISTS listAMSUserByName")
						and $mysqli->query($sqlStr)
						or die("Error: DROP/CREATE PROCEDURE failed: ({$mysqli->errno}) {$mysqli->error}");
				
				// CALL PROCEDURE with result set
				$resultSET = $mysqli->query("CALL listAMSUserByName(phong)")
									or die("Error: CALL failed: ({$mysqli->errno}) {$mysqli->errno}");
				tabulate_resultset($resultSET);
				$resultSET->close();
				
				// Disc from MySQL
				$mysqli->close();
				echo 'INFO: Connection closed!<br />';
				
				// Function to tabulate resultset
				function tabulate_resultset($resultSET){
					echo '<table><tr>';
					//Get fields name and print table header row
					$fields = $resultSET->fetch_fields();
					foreach ($fields as $headerfield) {
						echo "<th>{$headerfield->name}</th>";
						}
					echo '</tr>';
					
					//Fetch each row and print table details row
					while ($row=$resultSET->fetch_assoc()) {
						echo '<tr>';
						foreach ($row as $rowItem) {
							echo "<td>{$rowItem}</td>";	
						}
						echo '</tr>';
					}
					echo '</table>';
				}
				
		?>

	</body>

</html>